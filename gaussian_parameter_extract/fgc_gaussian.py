import pylab as plb
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit
from scipy import asarray as ar,exp
import numpy as np
from lmfit.models import GaussianModel, ConstantModel
from lxml import objectify as obj
#from Measurements.Analyses.ProcessFunctions.auxiliary import xml_to_array

# Define model function to be used to fit to the data above:
def readxml(inputxml):
    t = str.split(inputxml.text, ',')
    output_temp = []
    for number in t:
        output_temp.append(float(number))
    #print x_raw_temp
    output = np.array(output_temp)
    return output

def gauss(x, *p):
    A, mu, sigma, delta, voff = p
    return A*np.exp(-(x-mu)**2/(2.*sigma**2)) + A*np.exp(-(x-mu-delta)**2/(2.*sigma**2)) + voff
#+15degree, 11.0
#x_raw = ar([1510.0227,1510.5316,1511.0405,1511.5348,1512.0315,1512.5258,1513.0358,1513.5442,1514.0438,1514.541,1515.0301,1515.5341,1516.0339,1516.5347,1517.0431,1517.5464,1518.0495,1518.5388,1519.029,1519.5288,1520.0353,1520.5442,1521.0432,1521.5432,1522.0386,1522.5431,1523.0443,1523.5398,1524.0385,1524.5369,1525.0491,1525.5513,1526.0484,1526.5387,1527.0325,1527.5394,1528.0407,1528.5443,1529.0388,1529.5379,1530.0402,1530.5355,1531.0361,1531.5338,1532.042,1532.5417,1533.035,1533.5305,1534.0272,1534.5398,1535.0467,1535.5494,1536.0427,1536.5364,1537.0371,1537.5315,1538.0321,1538.5347,1539.038,1539.5403,1540.0303,1540.5341,1541.0356,1541.5473,1542.0483,1542.5452,1543.0417,1543.5389,1544.0447,1544.5379,1545.0308,1545.5269,1546.0278,1546.5403,1547.0401,1547.5401,1548.029,1548.5352,1549.0425,1549.5445,1550.0395,1550.5299,1551.0289,1551.5266,1552.0259,1552.5272,1553.031,1553.5385,1554.0327,1554.5275,1555.021,1555.5283,1556.0355,1556.5331,1557.0309,1557.522,1558.0279,1558.5263,1559.0272,1559.5271,1560.0264,1560.5299,1561.0173,1561.5164,1562.0133,1562.5268,1563.035,1563.5337,1564.0346,1564.5285,1565.0328,1565.5286,1566.0252,1566.5244,1567.029,1567.5389,1568.0338,1568.5275,1569.0193,1569.5252,1570.0283,1570.5338,1571.0279,1571.5249,1572.0301,1572.523,1573.0245,1573.5231,1574.0312,1574.5315,1575.0215,1575.516,1576.0145,1576.5293,1577.0368,1577.5374,1578.0313,1578.5285,1579.0284,1579.5226,1580.0261,1580.5249,1581.0318,1581.5303,1582.0259,1582.5258,1583.0297,1583.5376,1584.0365,1584.5374,1585.0322,1585.5352,1586.035,1586.5278,1587.0241,1587.5226,1588.0323,1588.5322,1589.0299,1589.5217,1590.0212,1590.5295,1591.0321,1591.5313,1592.0248,1592.5264,1593.0216,1593.5181,1594.0184,1594.5244,1595.028,1595.5223,1596.0198,1596.5159,1597.0268,1597.5319,1598.0335,1598.5275,1599.021,1599.5223,1600.0174,1600.5206,1601.0235,1601.5285,1602.0258,1602.5182,1603.0174,1603.5169,1604.0242,1604.5235,1605.0251,1605.5202,1606.0231,1606.5203,1607.0136,1607.5101,1608.0098,1608.5221,1609.0227,1609.5213,1610.0127,1610.514,1611.0187,1611.5211,1612.0196,1612.5145,1613.016,1613.5087,1614.0072,1614.5099,1615.0217,1615.5247,1616.0172,1616.5121,1617.011,1617.523,1618.0255,1618.5235,1619.0133,1619.5125,1620.0148,1620.5147,1621.0188,1621.5205,1622.0276,1622.5188,1623.0148,1623.5131,1624.017,1624.5204])
#y_raw = ar([-17.343708038330078,-17.290124893188477,-17.192445755004883,-17.051498413085938,-16.928583145141602,-16.854623794555664,-16.797601699829102,-16.764711380004883,-16.825265884399414,-16.758460998535156,-16.698038101196289,-16.56117057800293,-16.431425094604492,-16.400913238525391,-16.432928085327148,-16.418182373046875,-16.388322830200195,-16.493289947509766,-16.468660354614258,-16.326305389404297,-16.294918060302734,-16.245962142944336,-16.166498184204102,-16.174533843994141,-16.223880767822266,-16.217418670654297,-16.268104553222656,-16.217555999755859,-16.146139144897461,-16.121103286743164,-16.104990005493164,-16.105352401733398,-16.142826080322266,-16.243082046508789,-16.330890655517578,-16.405340194702148,-16.37367057800293,-16.364812850952148,-16.33137321472168,-16.325855255126953,-16.383245468139648,-16.427587509155273,-16.431549072265625,-16.531412124633789,-16.581836700439453,-16.595489501953125,-16.535493850708008,-16.547649383544922,-16.563764572143555,-16.607273101806641,-16.721954345703125,-16.849815368652344,-16.933889389038086,-16.976602554321289,-16.945890426635742,-16.980405807495117,-16.956447601318359,-16.991893768310547,-17.100311279296875,-17.18724250793457,-17.301858901977539,-17.41685676574707,-17.503269195556641,-17.487678527832031,-17.531558990478516,-17.58580207824707,-17.661479949951172,-17.818521499633789,-17.983089447021484,-18.084909439086914,-18.220046997070312,-18.221593856811523,-18.328380584716797,-18.29572868347168,-18.350639343261719,-18.484432220458984,-18.606523513793945,-18.810068130493164,-18.90794563293457,-19.002464294433594,-19.174167633056641,-19.197561264038086,-19.215158462524414,-19.30064582824707,-19.465255737304688,-19.654844284057617,-19.863527297973633,-19.991085052490234,-20.068765640258789,-20.123083114624023,-20.199708938598633,-20.302175521850586,-20.518936157226563,-20.509363174438477,-20.654012680053711,-20.831998825073242,-21.007419586181641,-21.141990661621094,-21.225057601928711,-21.267499923706055,-21.388582229614258,-21.540456771850586,-21.720266342163086,-21.865608215332031,-22.054529190063477,-22.239538192749023,-22.381828308105469,-22.486005783081055,-22.655641555786133,-22.688676834106445,-22.878812789916992,-23.01209831237793,-23.209877014160156,-23.424613952636719,-23.615257263183594,-23.717391967773438,-23.894124984741211,-24.02227783203125,-24.195348739624023,-24.389638900756836,-24.585422515869141,-24.855428695678711,-25.087701797485352,-25.360752105712891,-25.456207275390625,-25.619319915771484,-25.735317230224609,-25.871917724609375,-26.020021438598633,-26.224678039550781,-26.502967834472656,-26.681125640869141,-26.928150177001953,-27.188776016235352,-27.23969841003418,-27.416723251342773,-27.56702995300293,-27.813577651977539,-28.101484298706055,-28.343360900878906,-28.66880989074707,-28.933130264282227,-29.092090606689453,-29.290449142456055,-29.476293563842773,-29.690395355224609,-29.842052459716797,-30.206840515136719,-30.457420349121094,-30.739973068237305,-31.052753448486328,-31.362260818481445,-31.540464401245117,-31.836172103881836,-32.047588348388672,-32.317165374755859,-32.774238586425781,-33.048175811767578,-33.528221130371094,-33.667095184326172,-34.000095367431641,-34.248794555664062,-34.494682312011719,-34.741268157958984,-35.094741821289062,-35.373359680175781,-35.600700378417969,-35.888019561767578,-36.372413635253906,-36.669124603271484,-37.008293151855469,-37.373992919921875,-37.676918029785156,-37.936359405517578,-38.272571563720703,-38.684452056884766,-38.983169555664062,-39.326412200927734,-39.837574005126953,-40.263805389404297,-40.4661865234375,-40.880908966064453,-41.322513580322266,-41.668056488037109,-42.077365875244141,-42.341926574707031,-42.812709808349609,-43.1239013671875,-43.461048126220703,-43.799667358398438,-44.188446044921875,-44.312713623046875,-44.851028442382813,-45.387363433837891,-45.671016693115234,-46.202102661132812,-46.239841461181641,-47.030258178710938,-46.998065948486328,-47.145648956298828,-47.342967987060547,-47.306453704833984,-47.650581359863281,-47.977519989013672,-48.307228088378906,-48.461063385009766,-48.590988159179688,-49.144851684570313,-49.197872161865234,-49.251617431640625,-48.933811187744141,-49.220783233642578,-48.901901245117187,-48.756820678710938,-49.496189117431641,-49.331272125244141,-49.615749359130859,-49.964485168457031,-49.465370178222656,-49.560775756835938,-49.700893402099609,-49.369770050048828,-49.867557525634766,-49.370693206787109,-49.708976745605469,-50.451465606689453,-50.239414215087891,-49.4488525390625,-50.246486663818359,-49.862216949462891])
#+14.5degree, 10.5
#x_raw = ar([1510.0172,1510.5272,1511.0353,1511.5299,1512.0262,1512.5217,1513.0306,1513.5398,1514.039,1514.5365,1515.0246,1515.5301,1516.0288,1516.5295,1517.0387,1517.5423,1518.0449,1518.533,1519.0247,1519.5238,1520.0296,1520.5391,1521.0394,1521.5404,1522.0345,1522.539,1523.0403,1523.535,1524.0331,1524.5321,1525.0445,1525.5459,1526.0427,1526.5337,1527.0271,1527.5344,1528.0348,1528.5396,1529.0329,1529.5323,1530.0344,1530.529,1531.0298,1531.5292,1532.0359,1532.5367,1533.0299,1533.5246,1534.0215,1534.5341,1535.0409,1535.5436,1536.0375,1536.5311,1537.0325,1537.5262,1538.0272,1538.5282,1539.0322,1539.5346,1540.0249,1540.5283,1541.0292,1541.5421,1542.042,1542.5396,1543.0355,1543.5321,1544.037,1544.5311,1545.0252,1545.5197,1546.0201,1546.5347,1547.0358,1547.5321,1548.0206,1548.5268,1549.0329,1549.5375,1550.0327,1550.5237,1551.0232,1551.5194,1552.0192,1552.5204,1553.0265,1553.5319,1554.0262,1554.5198,1555.0136,1555.5219,1556.0301,1556.5288,1557.0248,1557.5171,1558.0225,1558.5209,1559.0214,1559.521,1560.021,1560.5232,1561.0126,1561.51,1562.0093,1562.5195,1563.03,1563.5283,1564.0287,1564.5226,1565.0273,1565.5231,1566.0212,1566.5201,1567.0238,1567.5341,1568.0301,1568.5231,1569.014,1569.5204,1570.0246,1570.5288,1571.0245,1571.5203,1572.0246,1572.5188,1573.0208,1573.5193,1574.026,1574.5259,1575.0162,1575.5103,1576.0092,1576.5223,1577.0319,1577.5326,1578.026,1578.5231,1579.0231,1579.5168,1580.0208,1580.5192,1581.025,1581.5244,1582.0195,1582.5196,1583.0226,1583.531,1584.0305,1584.5312,1585.0262,1585.5289,1586.0292,1586.5221,1587.018,1587.5161,1588.0258,1588.5261,1589.0244,1589.5165,1590.0149,1590.524,1591.0264,1591.526,1592.0185,1592.5204,1593.0149,1593.5115,1594.0123,1594.517,1595.0223,1595.5156,1596.014,1596.5109,1597.0202,1597.5277,1598.0281,1598.519,1599.0147,1599.5181,1600.0134,1600.515,1601.0144,1601.52,1602.0198,1602.513,1603.0113,1603.5103,1604.018,1604.5169,1605.0184,1605.5135,1606.0161,1606.515,1607.0085,1607.5035,1608.0041,1608.5159,1609.0184,1609.5161,1610.0076,1610.5077,1611.0137,1611.5154,1612.0142,1612.5075,1613.0105,1613.503,1614.0021,1614.5044,1615.0165,1615.519,1616.0117,1616.507,1617.0055,1617.5185,1618.0201,1618.5181,1619.0083,1619.5082,1620.0104,1620.5094,1621.014,1621.5155,1622.0225,1622.5133,1623.0095,1623.5076,1624.0126,1624.5175])
#y_raw = ar([-17.048589706420898,-17.001529693603516,-16.931123733520508,-16.789363861083984,-16.669839859008789,-16.571786880493164,-16.502578735351563,-16.392814636230469,-16.434280395507813,-16.35833740234375,-16.266351699829102,-16.183588027954102,-16.048954010009766,-15.984260559082031,-15.959779739379883,-15.937221527099609,-15.871011734008789,-15.914164543151855,-15.934660911560059,-15.738315582275391,-15.748116493225098,-15.647699356079102,-15.512966156005859,-15.483842849731445,-15.499963760375977,-15.46673583984375,-15.544491767883301,-15.455388069152832,-15.406664848327637,-15.364633560180664,-15.2518310546875,-15.262107849121094,-15.26221752166748,-15.338030815124512,-15.38995361328125,-15.412907600402832,-15.384882926940918,-15.365187644958496,-15.363584518432617,-15.311137199401855,-15.335800170898437,-15.346576690673828,-15.342743873596191,-15.445369720458984,-15.498361587524414,-15.449115753173828,-15.472551345825195,-15.41397762298584,-15.464479446411133,-15.513482093811035,-15.656543731689453,-15.729403495788574,-15.826676368713379,-15.86720085144043,-15.865298271179199,-15.917843818664551,-15.847380638122559,-15.922906875610352,-16.062658309936523,-16.135128021240234,-16.235326766967773,-16.409198760986328,-16.39152717590332,-16.373176574707031,-16.502473831176758,-16.488399505615234,-16.552515029907227,-16.711904525756836,-16.823307037353516,-16.94407844543457,-17.025840759277344,-17.080326080322266,-17.124221801757813,-17.125202178955078,-17.163545608520508,-17.255363464355469,-17.36469841003418,-17.514686584472656,-17.615776062011719,-17.71849250793457,-17.808135986328125,-17.877410888671875,-17.908369064331055,-17.994659423828125,-18.131790161132812,-18.283086776733398,-18.439992904663086,-18.554388046264648,-18.647514343261719,-18.71949577331543,-18.796222686767578,-18.910150527954102,-19.146059036254883,-19.121505737304687,-19.283742904663086,-19.449357986450195,-19.638561248779297,-19.758737564086914,-19.877582550048828,-19.927331924438477,-20.043388366699219,-20.201404571533203,-20.39008903503418,-20.534919738769531,-20.774381637573242,-20.943862915039063,-21.096927642822266,-21.194484710693359,-21.39225959777832,-21.394481658935547,-21.61192512512207,-21.738567352294922,-21.947519302368164,-22.164100646972656,-22.363275527954102,-22.457271575927734,-22.6405029296875,-22.751117706298828,-22.934591293334961,-23.123489379882813,-23.31524658203125,-23.560571670532227,-23.777135848999023,-24.032604217529297,-24.132404327392578,-24.304227828979492,-24.411891937255859,-24.533309936523438,-24.682781219482422,-24.891803741455078,-25.138788223266602,-25.350458145141602,-25.594940185546875,-25.825582504272461,-25.901533126831055,-26.084478378295898,-26.231637954711914,-26.501150131225586,-26.790708541870117,-27.047094345092773,-27.360567092895508,-27.660346984863281,-27.856094360351563,-28.027563095092773,-28.233135223388672,-28.486721038818359,-28.613121032714844,-28.999782562255859,-29.286441802978516,-29.571445465087891,-29.873245239257813,-30.205463409423828,-30.394031524658203,-30.69630241394043,-30.882511138916016,-31.147983551025391,-31.657112121582031,-31.909238815307617,-32.42218017578125,-32.570026397705078,-32.921123504638672,-33.151332855224609,-33.391830444335938,-33.670665740966797,-33.9969482421875,-34.249011993408203,-34.508659362792969,-34.86956787109375,-35.305141448974609,-35.591156005859375,-35.962944030761719,-36.264698028564453,-36.516983032226563,-36.843791961669922,-37.225547790527344,-37.580272674560547,-37.913867950439453,-38.280475616455078,-38.756153106689453,-39.216239929199219,-39.549736022949219,-39.943538665771484,-40.363552093505859,-40.649589538574219,-41.07965087890625,-41.412296295166016,-41.922191619873047,-42.407974243164063,-42.755828857421875,-43.273540496826172,-43.499656677246094,-43.939048767089844,-44.462009429931641,-44.744617462158203,-45.430686950683594,-45.690101623535156,-45.965629577636719,-46.294624328613281,-46.437419891357422,-47.229476928710938,-47.343128204345703,-47.597137451171875,-47.557689666748047,-47.754531860351562,-48.225513458251953,-48.404392242431641,-49.026802062988281,-48.402297973632813,-48.681461334228516,-49.393413543701172,-49.099533081054688,-49.699161529541016,-49.683025360107422,-49.257976531982422,-49.385166168212891,-49.441680908203125,-49.980808258056641,-49.718017578125,-49.659168243408203,-50.513717651367188,-49.621120452880859,-49.762611389160156,-50.084564208984375,-50.112342834472656,-50.279167175292969,-49.731342315673828,-49.923446655273438,-50.219863891601563,-50.694541931152344,-50.225666046142578])
#+14.0degree, 10.0
#x_raw = ar([1510.0252,1510.5346,1511.0412,1511.5365,1512.0321,1512.5261,1513.0365,1513.5454,1514.044,1514.542,1515.0298,1515.5347,1516.0334,1516.534,1517.0418,1517.5455,1518.0494,1518.5363,1519.0276,1519.5273,1520.0329,1520.5421,1521.0413,1521.5406,1522.0346,1522.5392,1523.0421,1523.536,1524.0349,1524.5329,1525.044,1525.546,1526.0428,1526.534,1527.0279,1527.5339,1528.0344,1528.5384,1529.0325,1529.5323,1530.0357,1530.53,1531.0283,1531.5265,1532.034,1532.5336,1533.027,1533.5212,1534.0173,1534.5291,1535.0375,1535.5393,1536.0338,1536.5273,1537.0286,1537.5223,1538.0231,1538.5252,1539.0291,1539.5313,1540.0206,1540.525,1541.0246,1541.5385,1542.0382,1542.5349,1543.0326,1543.5291,1544.0338,1544.5281,1545.0211,1545.5177,1546.0211,1546.5339,1547.0329,1547.532,1548.0197,1548.5262,1549.0339,1549.5375,1550.0348,1550.5256,1551.0261,1551.5225,1552.0234,1552.5254,1553.0318,1553.5375,1554.032,1554.5278,1555.022,1555.5271,1556.0356,1556.5339,1557.0318,1557.5241,1558.0291,1558.5264,1559.0287,1559.5278,1560.0285,1560.5303,1561.0182,1561.5172,1562.0143,1562.5269,1563.0363,1563.5355,1564.0356,1564.5292,1565.0332,1565.5293,1566.0262,1566.5249,1567.0296,1567.5378,1568.0339,1568.5276,1569.0183,1569.524,1570.0275,1570.5321,1571.0276,1571.5234,1572.0278,1572.5202,1573.0216,1573.5207,1574.0275,1574.528,1575.0173,1575.5117,1576.0099,1576.524,1577.0327,1577.5337,1578.0264,1578.5238,1579.0227,1579.5181,1580.0196,1580.5199,1581.0263,1581.5236,1582.0166,1582.5182,1583.0217,1583.5303,1584.0278,1584.529,1585.0232,1585.5256,1586.0259,1586.5182,1587.0148,1587.5131,1588.0224,1588.5214,1589.0198,1589.5126,1590.0102,1590.5188,1591.0224,1591.5217,1592.0148,1592.5167,1593.0113,1593.508,1594.0091,1594.5137,1595.0183,1595.5128,1596.0108,1596.5075,1597.0171,1597.5252,1598.0254,1598.5195,1599.0139,1599.5165,1600.0136,1600.5146,1601.0149,1601.5206,1602.0209,1602.515,1603.0142,1603.5153,1604.0229,1604.5206,1605.0234,1605.5197,1606.0211,1606.5212,1607.0142,1607.5105,1608.0105,1608.5225,1609.0231,1609.5225,1610.0136,1610.5145,1611.0195,1611.5221,1612.0203,1612.5146,1613.0164,1613.5079,1614.0078,1614.5109,1615.0226,1615.5247,1616.0183,1616.5126,1617.0104,1617.5246,1618.0249,1618.5228,1619.0133,1619.513,1620.0151,1620.5147,1621.0177,1621.5202,1622.0253,1622.5168,1623.0131,1623.5112,1624.0156,1624.5184])
#y_raw = ar([-18.128185272216797,-18.023378372192383,-17.884346008300781,-17.742015838623047,-17.649429321289063,-17.524372100830078,-17.423532485961914,-17.269506454467773,-17.240329742431641,-17.134950637817383,-17.063751220703125,-16.881988525390625,-16.774936676025391,-16.661037445068359,-16.639877319335937,-16.618213653564453,-16.619529724121094,-16.560752868652344,-16.495687484741211,-16.339183807373047,-16.260456085205078,-16.199319839477539,-16.084356307983398,-16.01356315612793,-15.943434715270996,-15.916376113891602,-15.951484680175781,-15.882527351379395,-15.796496391296387,-15.695947647094727,-15.636380195617676,-15.589718818664551,-15.621261596679687,-15.669922828674316,-15.673471450805664,-15.654317855834961,-15.653064727783203,-15.598379135131836,-15.578696250915527,-15.576935768127441,-15.441207885742188,-15.472594261169434,-15.504386901855469,-15.538570404052734,-15.58984375,-15.589529037475586,-15.571043014526367,-15.444045066833496,-15.456347465515137,-15.490174293518066,-15.585021018981934,-15.595319747924805,-15.693840026855469,-15.646449089050293,-15.681485176086426,-15.661231994628906,-15.602300643920898,-15.635032653808594,-15.704153060913086,-15.793310165405273,-15.854822158813477,-15.992045402526855,-15.897135734558105,-15.896459579467773,-15.938296318054199,-15.927996635437012,-16.001174926757813,-16.119258880615234,-16.223577499389648,-16.32878303527832,-16.398271560668945,-16.424219131469727,-16.432519912719727,-16.405397415161133,-16.418100357055664,-16.477874755859375,-16.616632461547852,-16.753360748291016,-16.856351852416992,-16.925998687744141,-16.995891571044922,-17.065469741821289,-17.084516525268555,-17.140396118164062,-17.264389038085938,-17.457645416259766,-17.579607009887695,-17.709327697753906,-17.771797180175781,-17.840915679931641,-17.882591247558594,-18.019477844238281,-18.206331253051758,-18.166324615478516,-18.334857940673828,-18.475372314453125,-18.628501892089844,-18.712528228759766,-18.797895431518555,-18.876680374145508,-18.942951202392578,-19.08192253112793,-19.258033752441406,-19.371162414550781,-19.602731704711914,-19.742254257202148,-19.877773284912109,-19.951572418212891,-20.084274291992188,-20.095663070678711,-20.286979675292969,-20.379512786865234,-20.560985565185547,-20.752925872802734,-20.93841552734375,-21.036760330200195,-21.179166793823242,-21.263675689697266,-21.405723571777344,-21.586483001708984,-21.777671813964844,-22.001079559326172,-22.178371429443359,-22.460765838623047,-22.526422500610352,-22.66673469543457,-22.776311874389648,-22.904270172119141,-23.033641815185547,-23.203887939453125,-23.446538925170898,-23.61564826965332,-23.882381439208984,-24.110605239868164,-24.163515090942383,-24.336456298828125,-24.4432373046875,-24.661333084106445,-24.921474456787109,-25.160335540771484,-25.464561462402344,-25.747398376464844,-25.905860900878906,-26.099002838134766,-26.262607574462891,-26.467252731323242,-26.603374481201172,-26.935850143432617,-27.174421310424805,-27.441553115844727,-27.752147674560547,-28.051443099975586,-28.21159553527832,-28.466110229492188,-28.654869079589844,-28.8963623046875,-29.364650726318359,-29.622797012329102,-30.055967330932617,-30.223232269287109,-30.556692123413086,-30.796201705932617,-31.00813102722168,-31.238775253295898,-31.53380012512207,-31.76679801940918,-32.047168731689453,-32.362110137939453,-32.82183837890625,-33.084117889404297,-33.440547943115234,-33.711799621582031,-33.960536956787109,-34.273658752441406,-34.625804901123047,-34.956649780273437,-35.295383453369141,-35.704875946044922,-36.160984039306641,-36.541053771972656,-36.890483856201172,-37.263019561767578,-37.667236328125,-38.078472137451172,-38.527862548828125,-38.782558441162109,-39.280754089355469,-39.707080841064453,-40.090579986572266,-40.556621551513672,-40.967082977294922,-41.279708862304688,-41.785530090332031,-42.314304351806641,-42.882068634033203,-43.156639099121094,-43.701633453369141,-44.360507965087891,-44.402854919433594,-44.694744110107422,-45.074195861816406,-45.493160247802734,-45.863948822021484,-46.378288269042969,-46.417106628417969,-46.892505645751953,-47.317466735839844,-47.694999694824219,-47.513973236083984,-47.837146759033203,-48.471942901611328,-48.604782104492188,-48.934467315673828,-48.950309753417969,-49.205802917480469,-49.592952728271484,-49.137565612792969,-49.446800231933594,-49.861598968505859,-50.011062622070313,-49.620956420898438,-50.148960113525391,-51.307975769042969,-50.342803955078125,-49.547698974609375,-50.167236328125,-50.011306762695313,-49.86016845703125,-49.883220672607422,-50.321414947509766])
#+13.5degree, 9.5
#x_raw = ar([1510.0192,1510.5272,1511.0356,1511.5302,1512.0265,1512.5215,1513.0316,1513.5384,1514.0385,1514.5363,1515.0256,1515.5296,1516.0294,1516.5291,1517.0377,1517.5407,1518.0444,1518.5325,1519.0239,1519.5235,1520.0299,1520.539,1521.0388,1521.5377,1522.0319,1522.5368,1523.0395,1523.5342,1524.0333,1524.5318,1525.0432,1525.5458,1526.0429,1526.5343,1527.0285,1527.5349,1528.0359,1528.5403,1529.0343,1529.5342,1530.0364,1530.5308,1531.0319,1531.5309,1532.0377,1532.5374,1533.0316,1533.5258,1534.0224,1534.5352,1535.0423,1535.545,1536.0388,1536.5327,1537.0337,1537.5277,1538.0283,1538.5302,1539.0334,1539.5356,1540.0263,1540.5299,1541.0305,1541.5437,1542.044,1542.5412,1543.0383,1543.5342,1544.0395,1544.5338,1545.0271,1545.5232,1546.0253,1546.5386,1547.0383,1547.5365,1548.0238,1548.5295,1549.0373,1549.5406,1550.0366,1550.5269,1551.028,1551.5258,1552.0234,1552.524,1553.0285,1553.5346,1554.0301,1554.5233,1555.0177,1555.5237,1556.0324,1556.5302,1557.0265,1557.5197,1558.0234,1558.5215,1559.0228,1559.5239,1560.0238,1560.5255,1561.0138,1561.5123,1562.0102,1562.5218,1563.0301,1563.529,1564.0283,1564.5215,1565.0269,1565.5226,1566.02,1566.5191,1567.0233,1567.5327,1568.0289,1568.5225,1569.0141,1569.5179,1570.0234,1570.5274,1571.023,1571.5203,1572.0237,1572.5176,1573.0196,1573.5192,1574.0257,1574.5256,1575.0151,1575.5103,1576.0089,1576.5226,1577.0318,1577.5336,1578.027,1578.5238,1579.024,1579.5173,1580.0217,1580.5203,1581.027,1581.5255,1582.0205,1582.5216,1583.0248,1583.5327,1584.0317,1584.5327,1585.027,1585.5293,1586.0295,1586.5229,1587.0189,1587.5176,1588.028,1588.527,1589.0254,1589.5181,1590.0163,1590.5247,1591.028,1591.5272,1592.0199,1592.5217,1593.0168,1593.5133,1594.0156,1594.5194,1595.0232,1595.5174,1596.0159,1596.5125,1597.0226,1597.5298,1598.0297,1598.5236,1599.0177,1599.5209,1600.0146,1600.5172,1601.0172,1601.5235,1602.0246,1602.5157,1603.0144,1603.5128,1604.0207,1604.5193,1605.0202,1605.5155,1606.0182,1606.5168,1607.0087,1607.5051,1608.005,1608.5175,1609.0177,1609.5167,1610.0079,1610.5083,1611.0132,1611.5147,1612.0156,1612.5088,1613.0106,1613.5032,1614.0022,1614.5059,1615.0164,1615.5193,1616.012,1616.5072,1617.0052,1617.5176,1618.0195,1618.5178,1619.0086,1619.5079,1620.01,1620.5095,1621.0123,1621.5145,1622.021,1622.5124,1623.0087,1623.5059,1624.0112,1624.515])
#y_raw = ar([-18.632932662963867,-18.60833740234375,-18.45469856262207,-18.338214874267578,-18.087112426757813,-17.922256469726563,-17.821891784667969,-17.74797248840332,-17.671459197998047,-17.612636566162109,-17.546741485595703,-17.378278732299805,-17.196996688842773,-17.042224884033203,-16.95475959777832,-16.894065856933594,-16.807611465454102,-16.805866241455078,-16.807950973510742,-16.605844497680664,-16.490222930908203,-16.374631881713867,-16.247943878173828,-16.19325065612793,-16.199214935302734,-16.097574234008789,-16.063018798828125,-15.992267608642578,-15.883685111999512,-15.764535903930664,-15.643677711486816,-15.596513748168945,-15.594825744628906,-15.555301666259766,-15.59759521484375,-15.64887809753418,-15.552629470825195,-15.449172019958496,-15.375845909118652,-15.308262825012207,-15.314077377319336,-15.311258316040039,-15.313499450683594,-15.289932250976562,-15.283134460449219,-15.277519226074219,-15.19483470916748,-15.108262062072754,-15.084714889526367,-15.121313095092773,-15.13107967376709,-15.23100757598877,-15.256305694580078,-15.247435569763184,-15.191332817077637,-15.225605964660645,-15.126805305480957,-15.126531600952148,-15.152744293212891,-15.222352981567383,-15.310703277587891,-15.363906860351563,-15.388216972351074,-15.361193656921387,-15.388468742370605,-15.432859420776367,-15.465030670166016,-15.578532218933105,-15.69386100769043,-15.761151313781738,-15.88758373260498,-15.878574371337891,-15.939753532409668,-15.885032653808594,-15.912768363952637,-15.987181663513184,-16.07905387878418,-16.241659164428711,-16.310420989990234,-16.358821868896484,-16.535036087036133,-16.512413024902344,-16.52076530456543,-16.565793991088867,-16.688325881958008,-16.85954475402832,-16.982442855834961,-17.112442016601563,-17.175010681152344,-17.21165657043457,-17.242727279663086,-17.306304931640625,-17.442169189453125,-17.436079025268555,-17.556943893432617,-17.696147918701172,-17.839815139770508,-17.920827865600586,-17.993072509765625,-18.027622222900391,-18.110378265380859,-18.22138786315918,-18.362857818603516,-18.49659538269043,-18.68461799621582,-18.839691162109375,-18.954296112060547,-19.048938751220703,-19.253175735473633,-19.230148315429688,-19.423908233642578,-19.51112174987793,-19.672342300415039,-19.847545623779297,-20.041202545166016,-20.14073371887207,-20.323503494262695,-20.43310546875,-20.605369567871094,-20.794921875,-20.961000442504883,-21.203884124755859,-21.372528076171875,-21.657796859741211,-21.754354476928711,-21.904951095581055,-22.038425445556641,-22.157014846801758,-22.286725997924805,-22.430673599243164,-22.677135467529297,-22.859132766723633,-23.129716873168945,-23.341499328613281,-23.405662536621094,-23.573427200317383,-23.677028656005859,-23.8719482421875,-24.127599716186523,-24.344215393066406,-24.635215759277344,-24.890909194946289,-25.060947418212891,-25.251461029052734,-25.418552398681641,-25.619462966918945,-25.736547470092773,-25.990291595458984,-26.225017547607422,-26.503950119018555,-26.788473129272461,-27.105619430541992,-27.344606399536133,-27.603565216064453,-27.763019561767578,-28.008451461791992,-28.419939041137695,-28.642171859741211,-29.122470855712891,-29.321565628051758,-29.699304580688477,-30.002796173095703,-30.287900924682617,-30.54957389831543,-30.793622970581055,-31.055624008178711,-31.337970733642578,-31.62115478515625,-32.119716644287109,-32.443611145019531,-32.824424743652344,-33.135177612304687,-33.456436157226563,-33.789119720458984,-34.149074554443359,-34.467548370361328,-34.764553070068359,-35.180423736572266,-35.609756469726563,-36.024082183837891,-36.440658569335938,-36.889598846435547,-37.229721069335938,-37.583251953125,-38.090724945068359,-38.332435607910156,-38.804130554199219,-39.228153228759766,-39.632526397705078,-40.052318572998047,-40.594043731689453,-40.985698699951172,-41.439159393310547,-41.9609375,-42.445899963378906,-42.834098815917969,-43.362495422363281,-43.811653137207031,-44.075542449951172,-44.802280426025391,-45.087295532226562,-45.380756378173828,-45.786922454833984,-46.222885131835938,-46.808628082275391,-47.245853424072266,-47.661823272705078,-47.69512939453125,-47.560924530029297,-47.664737701416016,-48.414085388183594,-48.544906616210938,-48.499065399169922,-48.820537567138672,-48.966838836669922,-49.188694000244141,-49.538856506347656,-49.522682189941406,-48.999225616455078,-49.18853759765625,-49.865447998046875,-48.458911895751953,-49.387840270996094,-49.604267120361328,-49.668262481689453,-49.260063171386719,-49.548076629638672,-49.649883270263672,-50.10687255859375,-49.950481414794922])
#+13.0degree, 9.0
#x_raw = ar([1510.0234,1510.5325,1511.0412,1511.5358,1512.0312,1512.5256,1513.0362,1513.5451,1514.0435,1514.5415,1515.0295,1515.5345,1516.0328,1516.5342,1517.0409,1517.5441,1518.0479,1518.5355,1519.027,1519.526,1520.0317,1520.5408,1521.0407,1521.5402,1522.034,1522.538,1523.0402,1523.5356,1524.0342,1524.5306,1525.0432,1525.5449,1526.0432,1526.5321,1527.0268,1527.5321,1528.0304,1528.5349,1529.0304,1529.5316,1530.0315,1530.5265,1531.0268,1531.5256,1532.0322,1532.5321,1533.0258,1533.5202,1534.0159,1534.5284,1535.037,1535.5393,1536.0336,1536.5273,1537.0276,1537.5218,1538.0225,1538.5242,1539.0274,1539.5293,1540.0205,1540.5227,1541.024,1541.5381,1542.0374,1542.5351,1543.0311,1543.5285,1544.0338,1544.5282,1545.0215,1545.5181,1546.0207,1546.5348,1547.0336,1547.5327,1548.0213,1548.5287,1549.0343,1549.5389,1550.0355,1550.5269,1551.0274,1551.5239,1552.0239,1552.5264,1553.0313,1553.5376,1554.0334,1554.5268,1555.0223,1555.528,1556.0369,1556.5335,1557.0305,1557.5235,1558.0291,1558.5262,1559.027,1559.528,1560.0279,1560.5303,1561.0179,1561.516,1562.0139,1562.5267,1563.0345,1563.5333,1564.0343,1564.5271,1565.0318,1565.5283,1566.0254,1566.523,1567.0277,1567.5375,1568.0324,1568.5251,1569.017,1569.523,1570.0257,1570.53,1571.0254,1571.5221,1572.0251,1572.5186,1573.0198,1573.5189,1574.0263,1574.5263,1575.016,1575.51,1576.009,1576.5218,1577.0306,1577.5309,1578.0228,1578.5205,1579.0205,1579.5142,1580.0182,1580.5158,1581.0228,1581.5213,1582.0159,1582.516,1583.02,1583.5272,1584.025,1584.5265,1585.0214,1585.524,1586.0238,1586.5169,1587.0127,1587.5109,1588.0206,1588.5208,1589.0197,1589.512,1590.0104,1590.519,1591.0212,1591.5211,1592.0136,1592.516,1593.0101,1593.5067,1594.0083,1594.5132,1595.0174,1595.5117,1596.0088,1596.5067,1597.017,1597.5237,1598.0249,1598.5185,1599.0126,1599.5166,1600.0122,1600.5149,1601.0146,1601.5217,1602.0205,1602.5151,1603.014,1603.5141,1604.0227,1604.5203,1605.0231,1605.5187,1606.021,1606.5198,1607.0129,1607.5083,1608.0088,1608.5215,1609.0223,1609.5211,1610.0113,1610.5129,1611.0176,1611.5205,1612.0195,1612.5125,1613.014,1613.5062,1614.0064,1614.509,1615.0199,1615.5227,1616.0164,1616.5108,1617.0095,1617.5232,1618.0238,1618.5214,1619.012,1619.5114,1620.0136,1620.5127,1621.0163,1621.5187,1622.0237,1622.5153,1623.0117,1623.5097,1624.0136,1624.5173])
#y_raw = ar([-19.975828170776367,-19.918697357177734,-19.74384880065918,-19.579961776733398,-19.352418899536133,-19.189018249511719,-19.025108337402344,-18.87755012512207,-18.819293975830078,-18.720077514648438,-18.637514114379883,-18.4544677734375,-18.248439788818359,-18.039278030395508,-17.913080215454102,-17.82136344909668,-17.722278594970703,-17.707145690917969,-17.720220565795898,-17.484916687011719,-17.308200836181641,-17.127847671508789,-16.988733291625977,-16.875907897949219,-16.811092376708984,-16.721168518066406,-16.708477020263672,-16.61540412902832,-16.47187614440918,-16.362964630126953,-16.216825485229492,-16.106651306152344,-16.085567474365234,-16.04719352722168,-16.057428359985352,-16.027759552001953,-15.966636657714844,-15.866475105285645,-15.852514266967773,-15.709480285644531,-15.671459197998047,-15.611824989318848,-15.542013168334961,-15.528928756713867,-15.526880264282227,-15.504435539245605,-15.424677848815918,-15.307940483093262,-15.285569190979004,-15.220359802246094,-15.263035774230957,-15.287528991699219,-15.316224098205566,-15.319035530090332,-15.244607925415039,-15.259538650512695,-15.101361274719238,-15.107574462890625,-15.13496208190918,-15.119633674621582,-15.152941703796387,-15.238552093505859,-15.224998474121094,-15.167511940002441,-15.165778160095215,-15.156173706054688,-15.160406112670898,-15.233598709106445,-15.26573371887207,-15.356929779052734,-15.408411026000977,-15.405062675476074,-15.458189964294434,-15.378833770751953,-15.329574584960938,-15.338859558105469,-15.40379810333252,-15.479825973510742,-15.561175346374512,-15.634805679321289,-15.730717658996582,-15.762715339660645,-15.729313850402832,-15.722949028015137,-15.798553466796875,-15.84334659576416,-16.014690399169922,-16.101144790649414,-16.188817977905273,-16.241367340087891,-16.261850357055664,-16.306554794311523,-16.437442779541016,-16.344558715820313,-16.440431594848633,-16.551898956298828,-16.685417175292969,-16.771547317504883,-16.86231803894043,-16.873296737670898,-16.92268180847168,-17.052963256835937,-17.172183990478516,-17.279132843017578,-17.401494979858398,-17.515869140625,-17.665035247802734,-17.706293106079102,-17.847585678100586,-17.817958831787109,-17.96827507019043,-18.056556701660156,-18.206277847290039,-18.385564804077148,-18.54045295715332,-18.601518630981445,-18.730737686157227,-18.789615631103516,-18.952484130859375,-19.101751327514648,-19.228408813476563,-19.433143615722656,-19.605195999145508,-19.845027923583984,-19.886362075805664,-20.050544738769531,-20.115585327148438,-20.183977127075195,-20.286680221557617,-20.446138381958008,-20.663909912109375,-20.833833694458008,-21.007888793945313,-21.213899612426758,-21.254806518554687,-21.388799667358398,-21.456336975097656,-21.65245246887207,-21.853580474853516,-22.056390762329102,-22.328983306884766,-22.575923919677734,-22.737634658813477,-22.879222869873047,-23.020339965820312,-23.202629089355469,-23.276287078857422,-23.58045768737793,-23.798141479492188,-24.020975112915039,-24.295919418334961,-24.567527770996094,-24.695106506347656,-24.923376083374023,-25.09846305847168,-25.321855545043945,-25.762399673461914,-26.002080917358398,-26.431177139282227,-26.519277572631836,-26.828014373779297,-27.057680130004883,-27.231851577758789,-27.46241569519043,-27.746173858642578,-27.993503570556641,-28.235738754272461,-28.500286102294922,-28.956476211547852,-29.164031982421875,-29.46577262878418,-29.738435745239258,-29.99687385559082,-30.295116424560547,-30.661447525024414,-30.927894592285156,-31.218999862670898,-31.547571182250977,-31.937921524047852,-32.35699462890625,-32.6612548828125,-33.054264068603516,-33.462760925292969,-33.792533874511719,-34.209575653076172,-34.374679565429687,-34.811386108398438,-35.2139892578125,-35.564300537109375,-36.059619903564453,-36.539321899414062,-36.813560485839844,-37.3233642578125,-37.813365936279297,-38.275672912597656,-38.656208038330078,-39.102203369140625,-39.652736663818359,-40.059711456298828,-40.594905853271484,-41.090003967285156,-41.502647399902344,-41.613250732421875,-42.233535766601563,-42.646152496337891,-43.345249176025391,-43.784595489501953,-44.234188079833984,-44.570697784423828,-44.963775634765625,-45.342365264892578,-45.544929504394531,-46.330539703369141,-46.515830993652344,-46.872379302978516,-47.174259185791016,-47.407939910888672,-47.860607147216797,-48.279750823974609,-48.231304168701172,-48.418205261230469,-48.645370483398437,-48.853828430175781,-49.185420989990234,-48.956375122070313,-49.731258392333984,-49.967132568359375,-49.860225677490234,-49.670745849609375,-50.6221923828125])
#+12.0degree, 8.5
#x_raw = ar([1510.0218,1510.531,1511.0384,1511.5323,1512.0299,1512.5225,1513.032,1513.5388,1514.0396,1514.5379,1515.0258,1515.5299,1516.0283,1516.5286,1517.0354,1517.5391,1518.0395,1518.5284,1519.0206,1519.5197,1520.0255,1520.5333,1521.0335,1521.5326,1522.028,1522.5319,1523.0335,1523.5281,1524.0274,1524.5259,1525.0364,1525.5395,1526.0365,1526.527,1527.0209,1527.527,1528.0295,1528.533,1529.0278,1529.527,1530.0287,1530.524,1531.0249,1531.5244,1532.0314,1532.5312,1533.0238,1533.5189,1534.0162,1534.5295,1535.0371,1535.5405,1536.0359,1536.5286,1537.03,1537.5245,1538.0254,1538.5279,1539.0307,1539.534,1540.0241,1540.5287,1541.0289,1541.5415,1542.0423,1542.5386,1543.0359,1543.533,1544.0386,1544.5323,1545.0248,1545.522,1546.0236,1546.5382,1547.0375,1547.5353,1548.0235,1548.5303,1549.0362,1549.5411,1550.0372,1550.528,1551.029,1551.5248,1552.025,1552.5264,1553.0307,1553.538,1554.0318,1554.5263,1555.0206,1555.5268,1556.0352,1556.5334,1557.0293,1557.522,1558.0268,1558.5251,1559.0257,1559.5265,1560.0279,1560.5288,1561.0164,1561.5147,1562.0124,1562.5243,1563.0327,1563.5321,1564.0307,1564.5253,1565.0289,1565.5249,1566.0209,1566.5176,1567.0236,1567.5324,1568.0281,1568.5206,1569.0117,1569.516,1570.02,1570.5242,1571.0196,1571.5153,1572.0203,1572.5134,1573.015,1573.513,1574.019,1574.5201,1575.0098,1575.5039,1576.0027,1576.5163,1577.0245,1577.5263,1578.0199,1578.5166,1579.0167,1579.5102,1580.0134,1580.5137,1581.0204,1581.5192,1582.0141,1582.5143,1583.0175,1583.527,1584.0245,1584.5267,1585.0211,1585.5248,1586.0254,1586.5183,1587.0148,1587.5131,1588.023,1588.5236,1589.0222,1589.5144,1590.0134,1590.5225,1591.0253,1591.5252,1592.0181,1592.5206,1593.0153,1593.512,1594.0135,1594.5186,1595.0223,1595.516,1596.0137,1596.5109,1597.0206,1597.5289,1598.0279,1598.5217,1599.0166,1599.5199,1600.0151,1600.5169,1601.0164,1601.5229,1602.0225,1602.5171,1603.0152,1603.515,1604.0227,1604.5216,1605.0229,1605.5192,1606.0217,1606.5202,1607.0115,1607.5079,1608.0088,1608.5213,1609.0226,1609.5201,1610.011,1610.5121,1611.0173,1611.5204,1612.0187,1612.5131,1613.0141,1613.5055,1614.0056,1614.5072,1615.0183,1615.5186,1616.0132,1616.5094,1617.0087,1617.5198,1618.0211,1618.5179,1619.0078,1619.5071,1620.0091,1620.5074,1621.0114,1621.5126,1622.0182,1622.5091,1623.0056,1623.5026,1624.0071,1624.5113])
#y_raw = ar([-20.717353820800781,-20.589105606079102,-20.395174026489258,-20.203876495361328,-19.999225616455078,-19.810598373413086,-19.611053466796875,-19.394418716430664,-19.329473495483398,-19.183692932128906,-19.070734024047852,-18.846523284912109,-18.640350341796875,-18.445262908935547,-18.354238510131836,-18.248130798339844,-18.138551712036133,-18.039102554321289,-17.978826522827148,-17.738981246948242,-17.593572616577148,-17.439662933349609,-17.282556533813477,-17.128904342651367,-17.011419296264648,-16.925807952880859,-16.893491744995117,-16.767978668212891,-16.609546661376953,-16.483739852905273,-16.345319747924805,-16.242425918579102,-16.173868179321289,-16.170904159545898,-16.122829437255859,-16.073392868041992,-15.995620727539063,-15.896133422851562,-15.813878059387207,-15.742752075195313,-15.614208221435547,-15.571887016296387,-15.48216724395752,-15.466464042663574,-15.443966865539551,-15.358811378479004,-15.301230430603027,-15.152641296386719,-15.107404708862305,-15.051383972167969,-15.096972465515137,-15.055078506469727,-15.107122421264648,-15.013875961303711,-14.967721939086914,-14.910514831542969,-14.771298408508301,-14.737549781799316,-14.799295425415039,-14.807096481323242,-14.790982246398926,-14.906371116638184,-14.756302833557129,-14.691245079040527,-14.744997978210449,-14.64250373840332,-14.643771171569824,-14.70256519317627,-14.74896240234375,-14.831006050109863,-14.826468467712402,-14.848978996276855,-14.784483909606934,-14.747294425964355,-14.708227157592773,-14.690239906311035,-14.734038352966309,-14.811020851135254,-14.880308151245117,-14.944663047790527,-14.938348770141602,-14.96129035949707,-14.942578315734863,-14.966726303100586,-15.020839691162109,-15.156781196594238,-15.21199893951416,-15.298507690429688,-15.343350410461426,-15.388467788696289,-15.405089378356934,-15.498289108276367,-15.705431938171387,-15.596424102783203,-15.737504005432129,-15.836763381958008,-15.952126502990723,-16.005661010742187,-16.080692291259766,-16.118509292602539,-16.168516159057617,-16.293746948242187,-16.437997817993164,-16.502355575561523,-16.696426391601563,-16.789196014404297,-16.902364730834961,-16.959074020385742,-17.072446823120117,-17.058958053588867,-17.217161178588867,-17.267814636230469,-17.407142639160156,-17.571435928344727,-17.731117248535156,-17.789058685302734,-17.926191329956055,-17.972370147705078,-18.063653945922852,-18.192218780517578,-18.349699020385742,-18.521955490112305,-18.673336029052734,-18.913564682006836,-18.974405288696289,-19.074390411376953,-19.12965202331543,-19.222162246704102,-19.309085845947266,-19.445030212402344,-19.648115158081055,-19.799831390380859,-19.998218536376953,-20.201019287109375,-20.263734817504883,-20.401508331298828,-20.473798751831055,-20.656412124633789,-20.869104385375977,-21.056541442871094,-21.336147308349609,-21.617738723754883,-21.776399612426758,-21.927001953125,-22.079559326171875,-22.271512985229492,-22.331344604492188,-22.657548904418945,-22.885993957519531,-23.126838684082031,-23.419031143188477,-23.678197860717773,-23.829818725585937,-24.075054168701172,-24.21021842956543,-24.419063568115234,-24.889307022094727,-25.10508918762207,-25.573505401611328,-25.701517105102539,-26.009206771850586,-26.221502304077148,-26.428022384643555,-26.649080276489258,-26.901569366455078,-27.099100112915039,-27.345392227172852,-27.618442535400391,-28.047578811645508,-28.295351028442383,-28.623636245727539,-28.890464782714844,-29.150575637817383,-29.432374954223633,-29.757144927978516,-30.048515319824219,-30.355598449707031,-30.742450714111328,-31.184360504150391,-31.571184158325195,-31.895496368408203,-32.276130676269531,-32.660717010498047,-33.024742126464844,-33.476119995117187,-33.707389831542969,-34.161235809326172,-34.587802886962891,-34.967601776123047,-35.499507904052734,-35.973445892333984,-36.317615509033203,-36.915725708007813,-37.444705963134766,-37.902816772460938,-38.422088623046875,-38.830738067626953,-39.504962921142578,-39.877822875976563,-40.406585693359375,-41.064319610595703,-41.379314422607422,-41.774234771728516,-42.294986724853516,-42.752174377441406,-43.525222778320312,-43.9644775390625,-44.434864044189453,-44.606304168701172,-45.217681884765625,-45.51611328125,-46.102287292480469,-46.551841735839844,-46.951187133789063,-47.511959075927734,-47.664398193359375,-48.257839202880859,-48.722465515136719,-48.426467895507813,-48.318233489990234,-49.278675079345703,-49.258853912353516,-49.621253967285156,-49.644474029541016,-49.316596984863281,-49.56866455078125,-50.147106170654297,-49.947635650634766,-49.199668884277344,-49.567890167236328])
#+11.5degree, 8.0
#x_raw = ar([1510.0208,1510.5302,1511.0379,1511.5329,1512.0293,1512.524,1513.0326,1513.5416,1514.0405,1514.5385,1515.0274,1515.5311,1516.0301,1516.5321,1517.0392,1517.5425,1518.0455,1518.5339,1519.0249,1519.5235,1520.0292,1520.5385,1521.0368,1521.5361,1522.0305,1522.5345,1523.0373,1523.5331,1524.0314,1524.5256,1525.0374,1525.5394,1526.0359,1526.5273,1527.021,1527.5269,1528.0279,1528.5325,1529.0262,1529.5262,1530.0273,1530.5227,1531.0226,1531.5218,1532.0292,1532.5286,1533.0219,1533.5175,1534.014,1534.5254,1535.0347,1535.5374,1536.0319,1536.5248,1537.0255,1537.52,1538.0214,1538.5226,1539.026,1539.5281,1540.0184,1540.5213,1541.0233,1541.5368,1542.0364,1542.5339,1543.0308,1543.528,1544.0327,1544.5274,1545.0207,1545.5185,1546.0209,1546.5341,1547.0336,1547.533,1548.0213,1548.5277,1549.0354,1549.5391,1550.036,1550.5273,1551.027,1551.524,1552.0233,1552.5257,1553.0298,1553.5369,1554.0302,1554.5254,1555.0188,1555.5262,1556.0341,1556.5317,1557.0287,1557.5207,1558.026,1558.5236,1559.0247,1559.5248,1560.0252,1560.5276,1561.0152,1561.5129,1562.0121,1562.5244,1563.0332,1563.5326,1564.031,1564.5262,1565.0306,1565.5261,1566.0222,1566.5219,1567.0259,1567.5354,1568.0298,1568.5234,1569.0148,1569.5195,1570.0244,1570.5275,1571.0232,1571.5193,1572.0238,1572.5155,1573.0175,1573.5173,1574.0232,1574.5238,1575.0126,1575.5042,1576.0031,1576.5163,1577.0247,1577.5269,1578.0201,1578.5168,1579.0171,1579.5098,1580.0132,1580.5133,1581.0184,1581.5169,1582.0127,1582.5129,1583.0151,1583.5246,1584.0235,1584.5237,1585.0186,1585.5218,1586.0212,1586.5156,1587.0109,1587.5096,1588.0191,1588.5189,1589.0175,1589.5099,1590.0082,1590.5169,1591.0197,1591.5197,1592.0129,1592.514,1593.0104,1593.506,1594.0077,1594.5128,1595.017,1595.5115,1596.0092,1596.5061,1597.016,1597.525,1598.0255,1598.5189,1599.0138,1599.5174,1600.0131,1600.5155,1601.0159,1601.5216,1602.0216,1602.5146,1603.0134,1603.5131,1604.0209,1604.5205,1605.0217,1605.5173,1606.0194,1606.5182,1607.0101,1607.5068,1608.0071,1608.5196,1609.0207,1609.5186,1610.01,1610.5105,1611.0156,1611.5186,1612.0167,1612.511,1613.0119,1613.5056,1614.0048,1614.5078,1615.0193,1615.5221,1616.0146,1616.5092,1617.0077,1617.52,1618.0223,1618.5187,1619.01,1619.5092,1620.0099,1620.5102,1621.0137,1621.5155,1622.0203,1622.5123,1623.009,1623.5069,1624.0118,1624.5164])
#y_raw = ar([-22.405715942382813,-22.248315811157227,-22.053016662597656,-21.800394058227539,-21.625955581665039,-21.410137176513672,-21.209453582763672,-20.936101913452148,-20.881925582885742,-20.680871963500977,-20.525588989257813,-20.263761520385742,-20.056575775146484,-19.866567611694336,-19.754470825195313,-19.619932174682617,-19.496364593505859,-19.386425018310547,-19.25318717956543,-18.968193054199219,-18.841497421264648,-18.690126419067383,-18.454069137573242,-18.275173187255859,-18.132621765136719,-18.026660919189453,-17.988349914550781,-17.826700210571289,-17.660249710083008,-17.508039474487305,-17.332271575927734,-17.221162796020508,-17.123218536376953,-17.08531379699707,-17.038518905639648,-16.963617324829102,-16.834123611450195,-16.717344284057617,-16.625751495361328,-16.515647888183594,-16.399818420410156,-16.287708282470703,-16.184484481811523,-16.15776252746582,-16.123067855834961,-16.018890380859375,-15.936452865600586,-15.788228988647461,-15.709367752075195,-15.659036636352539,-15.61638355255127,-15.61334228515625,-15.586030960083008,-15.531342506408691,-15.451549530029297,-15.417159080505371,-15.24191951751709,-15.169781684875488,-15.184613227844238,-15.157497406005859,-15.164961814880371,-15.250646591186523,-15.128497123718262,-15.020374298095703,-15.079591751098633,-14.991185188293457,-14.963403701782227,-15.01830005645752,-15.052685737609863,-15.084575653076172,-15.094922065734863,-15.080177307128906,-15.026492118835449,-14.971720695495605,-14.964550018310547,-14.986340522766113,-14.982373237609863,-15.077774047851563,-15.073947906494141,-15.09234619140625,-15.11749267578125,-15.08100700378418,-15.063412666320801,-15.081647872924805,-15.128927230834961,-15.234662055969238,-15.265422821044922,-15.347700119018555,-15.361766815185547,-15.366703987121582,-15.357009887695313,-15.378541946411133,-15.525381088256836,-15.457094192504883,-15.563252449035645,-15.65577220916748,-15.783328056335449,-15.832945823669434,-15.889346122741699,-15.877164840698242,-15.925895690917969,-16.015996932983398,-16.176149368286133,-16.233245849609375,-16.461910247802734,-16.542856216430664,-16.621719360351563,-16.68443489074707,-16.848934173583984,-16.78297233581543,-16.967599868774414,-17.034126281738281,-17.18528938293457,-17.339649200439453,-17.494880676269531,-17.514904022216797,-17.683450698852539,-17.769374847412109,-17.87809944152832,-18.006393432617188,-18.167434692382812,-18.322093963623047,-18.454132080078125,-18.702945709228516,-18.761865615844727,-18.833566665649414,-18.906293869018555,-18.982217788696289,-19.080194473266602,-19.186098098754883,-19.363935470581055,-19.518199920654297,-19.728116989135742,-19.885322570800781,-19.92970085144043,-20.048055648803711,-20.146266937255859,-20.296085357666016,-20.503509521484375,-20.684196472167969,-20.931386947631836,-21.161184310913086,-21.309001922607422,-21.456888198852539,-21.611963272094727,-21.791908264160156,-21.856271743774414,-22.155235290527344,-22.37523078918457,-22.619739532470703,-22.884521484375,-23.176746368408203,-23.338380813598633,-23.583847045898437,-23.71923828125,-23.892156600952148,-24.369964599609375,-24.605646133422852,-25.066806793212891,-25.194911956787109,-25.545019149780273,-25.797483444213867,-25.999967575073242,-26.190303802490234,-26.430271148681641,-26.619964599609375,-26.882125854492187,-27.217052459716797,-27.704311370849609,-27.920148849487305,-28.258665084838867,-28.521686553955078,-28.7606201171875,-29.08856201171875,-29.400976181030273,-29.663408279418945,-29.999591827392578,-30.38304328918457,-30.794050216674805,-31.205314636230469,-31.518743515014648,-31.935630798339844,-32.240119934082031,-32.602252960205078,-33.155605316162109,-33.419681549072266,-33.858154296875,-34.290054321289063,-34.628257751464844,-35.188209533691406,-35.649612426757813,-36.018581390380859,-36.589309692382813,-37.117095947265625,-37.661735534667969,-38.135257720947266,-38.679214477539063,-39.227104187011719,-39.703361511230469,-40.16754150390625,-40.834823608398437,-41.401523590087891,-41.804782867431641,-42.357372283935547,-42.813976287841797,-43.479587554931641,-44.015865325927734,-44.322238922119141,-44.914768218994141,-45.400306701660156,-45.790786743164063,-46.401004791259766,-46.947471618652344,-47.1209716796875,-47.53582763671875,-48.106380462646484,-48.036003112792969,-48.327869415283203,-48.735214233398438,-49.117683410644531,-49.206069946289063,-48.807308197021484,-49.387779235839844,-49.0780029296875,-49.061389923095703,-49.297451019287109,-49.710914611816406,-50.081546783447266,-50.152961730957031,-50.225715637207031])
#+10.0degree, 7.5	
#x_raw = ar([1510.0196,1510.5286,1511.0371,1511.5321,1512.0s27,1512.5201,1513.0312,1513.5396,1514.0368,1514.532,1515.022,1515.5281,1516.0274,1516.5262,1517.0342,1517.5373,1518.0407,1518.5281,1519.0195,1519.5197,1520.0236,1520.533,1521.0327,1521.5327,1522.027,1522.5302,1523.0331,1523.5286,1524.026,1524.525,1525.0365,1525.5386,1526.0357,1526.5262,1527.0205,1527.5269,1528.0286,1528.5326,1529.0266,1529.5258,1530.0285,1530.5241,1531.0251,1531.5236,1532.0305,1532.53,1533.0229,1533.5193,1534.0153,1534.5288,1535.0378,1535.5398,1536.0343,1536.5285,1537.0295,1537.5238,1538.025,1538.5265,1539.0302,1539.5319,1540.0229,1540.5266,1541.0277,1541.5415,1542.0403,1542.5373,1543.0352,1543.5318,1544.0371,1544.5311,1545.025,1545.5206,1546.0226,1546.5373,1547.036,1547.5347,1548.0228,1548.5285,1549.0361,1549.5406,1550.0367,1550.5266,1551.0278,1551.5242,1552.0235,1552.5248,1553.0309,1553.5367,1554.0302,1554.5252,1555.0184,1555.5256,1556.0338,1556.5319,1557.0285,1557.5215,1558.0259,1558.5238,1559.0248,1559.5263,1560.0263,1560.5278,1561.0159,1561.5143,1562.0129,1562.5227,1563.033,1563.5298,1564.0293,1564.5246,1565.0293,1565.5249,1566.021,1566.5189,1567.0226,1567.5312,1568.0266,1568.5198,1569.0109,1569.516,1570.0208,1570.5247,1571.0198,1571.5155,1572.0191,1572.5113,1573.0122,1573.5119,1574.0171,1574.518,1575.0079,1575.502,1575.9997,1576.5133,1577.0231,1577.5261,1578.0189,1578.5154,1579.0167,1579.5089,1580.0128,1580.5128,1581.019,1581.5173,1582.0128,1582.5134,1583.016,1583.525,1584.0239,1584.5258,1585.0206,1585.5225,1586.0233,1586.5167,1587.0126,1587.512,1588.022,1588.5218,1589.0208,1589.5139,1590.0132,1590.5211,1591.0245,1591.5238,1592.0169,1592.5196,1593.0134,1593.5105,1594.0117,1594.516,1595.02,1595.5134,1596.0118,1596.5088,1597.0187,1597.5266,1598.0268,1598.5211,1599.0156,1599.5189,1600.0141,1600.516,1601.016,1601.5209,1602.0221,1602.5146,1603.013,1603.5128,1604.0218,1604.5199,1605.0212,1605.5182,1606.0195,1606.5179,1607.011,1607.5073,1608.0082,1608.5203,1609.02,1609.5193,1610.0091,1610.5108,1611.016,1611.5184,1612.0179,1612.5108,1613.0132,1613.5051,1614.0025,1614.5061,1615.0185,1615.52,1616.0133,1616.5046,1617.0056,1617.5163,1618.0181,1618.5154,1619.0068,1619.5046,1620.006,1620.5054,1621.0095,1621.51,1622.0169,1622.5082,1623.0046,1623.5019,1624.0058,1624.5101])
#y_raw = ar([-24.057806015014648,-23.946317672729492,-23.75282096862793,-23.572376251220703,-23.338973999023438,-23.104557037353516,-22.884113311767578,-22.660003662109375,-22.561113357543945,-22.42042350769043,-22.285659790039063,-22.041534423828125,-21.804609298706055,-21.576534271240234,-21.448863983154297,-21.303560256958008,-21.177587509155273,-21.07081413269043,-20.93876838684082,-20.678308486938477,-20.490524291992188,-20.314090728759766,-20.117168426513672,-19.933603286743164,-19.78577995300293,-19.617361068725586,-19.522777557373047,-19.380525588989258,-19.17997932434082,-18.969966888427734,-18.774482727050781,-18.593025207519531,-18.497833251953125,-18.424327850341797,-18.341123580932617,-18.256126403808594,-18.098474502563477,-17.91325569152832,-17.75543212890625,-17.625564575195313,-17.450904846191406,-17.379621505737305,-17.262676239013672,-17.174537658691406,-17.081319808959961,-16.993141174316406,-16.813339233398438,-16.639139175415039,-16.52757453918457,-16.427286148071289,-16.411140441894531,-16.343973159790039,-16.327381134033203,-16.193157196044922,-16.091516494750977,-15.970961570739746,-15.889710426330566,-15.806929588317871,-15.733906745910645,-15.713761329650879,-15.664427757263184,-15.645350456237793,-15.575150489807129,-15.489316940307617,-15.373679161071777,-15.314512252807617,-15.279855728149414,-15.27567195892334,-15.325763702392578,-15.290909767150879,-15.331643104553223,-15.217769622802734,-15.21617317199707,-15.055276870727539,-15.002053260803223,-14.988292694091797,-14.971526145935059,-15.022444725036621,-15.009856224060059,-14.970912933349609,-15.050315856933594,-15.00454044342041,-14.940582275390625,-14.897773742675781,-14.94524097442627,-15.062819480895996,-15.122420310974121,-15.186071395874023,-15.179648399353027,-15.151126861572266,-15.094350814819336,-15.09482479095459,-15.13578987121582,-15.061670303344727,-15.09760856628418,-15.166591644287109,-15.211099624633789,-15.247358322143555,-15.230311393737793,-15.21096134185791,-15.199553489685059,-15.231618881225586,-15.281603813171387,-15.357376098632812,-15.416465759277344,-15.514884948730469,-15.55073356628418,-15.549376487731934,-15.605953216552734,-15.54885196685791,-15.603811264038086,-15.64256763458252,-15.74420166015625,-15.84660530090332,-15.961145401000977,-16.008829116821289,-16.053226470947266,-16.094263076782227,-16.173669815063477,-16.314006805419922,-16.416843414306641,-16.594568252563477,-16.705842971801758,-16.935440063476563,-16.959012985229492,-17.083650588989258,-17.174375534057617,-17.23579216003418,-17.289348602294922,-17.373769760131836,-17.566858291625977,-17.653806686401367,-17.847549438476563,-18.044986724853516,-18.039113998413086,-18.150121688842773,-18.172998428344727,-18.306770324707031,-18.490766525268555,-18.622045516967773,-18.852432250976562,-19.035579681396484,-19.096090316772461,-19.195623397827148,-19.280160903930664,-19.410318374633789,-19.454639434814453,-19.673061370849609,-19.803281784057617,-19.943870544433594,-20.134210586547852,-20.326148986816406,-20.428129196166992,-20.594423294067383,-20.693338394165039,-20.866804122924805,-21.182113647460937,-21.348161697387695,-21.702699661254883,-21.815053939819336,-22.067659378051758,-22.248447418212891,-22.394283294677734,-22.541261672973633,-22.749588012695313,-22.941549301147461,-23.14140510559082,-23.379243850708008,-23.809202194213867,-24.039707183837891,-24.312978744506836,-24.470958709716797,-24.670009613037109,-24.921714782714844,-25.240007400512695,-25.527385711669922,-25.820425033569336,-26.135011672973633,-26.46879768371582,-26.840909957885742,-27.13935661315918,-27.475748062133789,-27.76995849609375,-28.075624465942383,-28.510492324829102,-28.674064636230469,-29.096487045288086,-29.399435043334961,-29.658405303955078,-30.089235305786133,-30.515754699707031,-30.824121475219727,-31.337907791137695,-31.744451522827148,-32.213680267333984,-32.625560760498047,-33.042488098144531,-33.586662292480469,-33.854522705078125,-34.246883392333984,-34.77447509765625,-35.156402587890625,-35.478717803955078,-36.017684936523438,-36.419525146484375,-36.996128082275391,-37.475513458251953,-37.944705963134766,-38.317722320556641,-38.800022125244141,-39.332756042480469,-39.814510345458984,-40.517528533935547,-40.920856475830078,-41.486358642578125,-42.005428314208984,-42.632450103759766,-43.288738250732422,-43.729610443115234,-44.304676055908203,-45.030567169189453,-45.251136779785156,-45.788860321044922,-46.133846282958984,-46.817672729492188,-46.992988586425781,-47.512283325195313,-48.023807525634766,-48.3260498046875,-48.82171630859375])


"""
if 1:
    #measurement with identical input and output angles
    x_raw = ar([1510.0196,1510.5286,1511.0371,1511.5321,1512.027,1512.5201,1513.0312,1513.5396,1514.0368,1514.532,1515.022,1515.5281,1516.0274,1516.5262,1517.0342,1517.5373,1518.0407,1518.5281,1519.0195,1519.5197,1520.0236,1520.533,1521.0327,1521.5327,1522.027,1522.5302,1523.0331,1523.5286,1524.026,1524.525,1525.0365,1525.5386,1526.0357,1526.5262,1527.0205,1527.5269,1528.0286,1528.5326,1529.0266,1529.5258,1530.0285,1530.5241,1531.0251,1531.5236,1532.0305,1532.53,1533.0229,1533.5193,1534.0153,1534.5288,1535.0378,1535.5398,1536.0343,1536.5285,1537.0295,1537.5238,1538.025,1538.5265,1539.0302,1539.5319,1540.0229,1540.5266,1541.0277,1541.5415,1542.0403,1542.5373,1543.0352,1543.5318,1544.0371,1544.5311,1545.025,1545.5206,1546.0226,1546.5373,1547.036,1547.5347,1548.0228,1548.5285,1549.0361,1549.5406,1550.0367,1550.5266,1551.0278,1551.5242,1552.0235,1552.5248,1553.0309,1553.5367,1554.0302,1554.5252,1555.0184,1555.5256,1556.0338,1556.5319,1557.0285,1557.5215,1558.0259,1558.5238,1559.0248,1559.5263,1560.0263,1560.5278,1561.0159,1561.5143,1562.0129,1562.5227,1563.033,1563.5298,1564.0293,1564.5246,1565.0293,1565.5249,1566.021,1566.5189,1567.0226,1567.5312,1568.0266,1568.5198,1569.0109,1569.516,1570.0208,1570.5247,1571.0198,1571.5155,1572.0191,1572.5113,1573.0122,1573.5119,1574.0171,1574.518,1575.0079,1575.502,1575.9997,1576.5133,1577.0231,1577.5261,1578.0189,1578.5154,1579.0167,1579.5089,1580.0128,1580.5128,1581.019,1581.5173,1582.0128,1582.5134,1583.016,1583.525,1584.0239,1584.5258,1585.0206,1585.5225,1586.0233,1586.5167,1587.0126,1587.512,1588.022,1588.5218,1589.0208,1589.5139,1590.0132,1590.5211,1591.0245,1591.5238,1592.0169,1592.5196,1593.0134,1593.5105,1594.0117,1594.516,1595.02,1595.5134,1596.0118,1596.5088,1597.0187,1597.5266,1598.0268,1598.5211,1599.0156,1599.5189,1600.0141,1600.516,1601.016,1601.5209,1602.0221,1602.5146,1603.013,1603.5128,1604.0218,1604.5199,1605.0212,1605.5182,1606.0195,1606.5179,1607.011,1607.5073,1608.0082,1608.5203,1609.02,1609.5193,1610.0091,1610.5108,1611.016,1611.5184,1612.0179,1612.5108,1613.0132,1613.5051,1614.0025,1614.5061,1615.0185,1615.52,1616.0133,1616.5046,1617.0056,1617.5163,1618.0181,1618.5154,1619.0068,1619.5046,1620.006,1620.5054,1621.0095,1621.51,1622.0169,1622.5082,1623.0046,1623.5019,1624.0058,1624.5101])
    y_raw = ar([-24.057806015014648,-23.946317672729492,-23.75282096862793,-23.572376251220703,-23.338973999023438,-23.104557037353516,-22.884113311767578,-22.660003662109375,-22.561113357543945,-22.42042350769043,-22.285659790039063,-22.041534423828125,-21.804609298706055,-21.576534271240234,-21.448863983154297,-21.303560256958008,-21.177587509155273,-21.07081413269043,-20.93876838684082,-20.678308486938477,-20.490524291992188,-20.314090728759766,-20.117168426513672,-19.933603286743164,-19.78577995300293,-19.617361068725586,-19.522777557373047,-19.380525588989258,-19.17997932434082,-18.969966888427734,-18.774482727050781,-18.593025207519531,-18.497833251953125,-18.424327850341797,-18.341123580932617,-18.256126403808594,-18.098474502563477,-17.91325569152832,-17.75543212890625,-17.625564575195313,-17.450904846191406,-17.379621505737305,-17.262676239013672,-17.174537658691406,-17.081319808959961,-16.993141174316406,-16.813339233398438,-16.639139175415039,-16.52757453918457,-16.427286148071289,-16.411140441894531,-16.343973159790039,-16.327381134033203,-16.193157196044922,-16.091516494750977,-15.970961570739746,-15.889710426330566,-15.806929588317871,-15.733906745910645,-15.713761329650879,-15.664427757263184,-15.645350456237793,-15.575150489807129,-15.489316940307617,-15.373679161071777,-15.314512252807617,-15.279855728149414,-15.27567195892334,-15.325763702392578,-15.290909767150879,-15.331643104553223,-15.217769622802734,-15.21617317199707,-15.055276870727539,-15.002053260803223,-14.988292694091797,-14.971526145935059,-15.022444725036621,-15.009856224060059,-14.970912933349609,-15.050315856933594,-15.00454044342041,-14.940582275390625,-14.897773742675781,-14.94524097442627,-15.062819480895996,-15.122420310974121,-15.186071395874023,-15.179648399353027,-15.151126861572266,-15.094350814819336,-15.09482479095459,-15.13578987121582,-15.061670303344727,-15.09760856628418,-15.166591644287109,-15.211099624633789,-15.247358322143555,-15.230311393737793,-15.21096134185791,-15.199553489685059,-15.231618881225586,-15.281603813171387,-15.357376098632812,-15.416465759277344,-15.514884948730469,-15.55073356628418,-15.549376487731934,-15.605953216552734,-15.54885196685791,-15.603811264038086,-15.64256763458252,-15.74420166015625,-15.84660530090332,-15.961145401000977,-16.008829116821289,-16.053226470947266,-16.094263076782227,-16.173669815063477,-16.314006805419922,-16.416843414306641,-16.594568252563477,-16.705842971801758,-16.935440063476563,-16.959012985229492,-17.083650588989258,-17.174375534057617,-17.23579216003418,-17.289348602294922,-17.373769760131836,-17.566858291625977,-17.653806686401367,-17.847549438476563,-18.044986724853516,-18.039113998413086,-18.150121688842773,-18.172998428344727,-18.306770324707031,-18.490766525268555,-18.622045516967773,-18.852432250976562,-19.035579681396484,-19.096090316772461,-19.195623397827148,-19.280160903930664,-19.410318374633789,-19.454639434814453,-19.673061370849609,-19.803281784057617,-19.943870544433594,-20.134210586547852,-20.326148986816406,-20.428129196166992,-20.594423294067383,-20.693338394165039,-20.866804122924805,-21.182113647460937,-21.348161697387695,-21.702699661254883,-21.815053939819336,-22.067659378051758,-22.248447418212891,-22.394283294677734,-22.541261672973633,-22.749588012695313,-22.941549301147461,-23.14140510559082,-23.379243850708008,-23.809202194213867,-24.039707183837891,-24.312978744506836,-24.470958709716797,-24.670009613037109,-24.921714782714844,-25.240007400512695,-25.527385711669922,-25.820425033569336,-26.135011672973633,-26.46879768371582,-26.840909957885742,-27.13935661315918,-27.475748062133789,-27.76995849609375,-28.075624465942383,-28.510492324829102,-28.674064636230469,-29.096487045288086,-29.399435043334961,-29.658405303955078,-30.089235305786133,-30.515754699707031,-30.824121475219727,-31.337907791137695,-31.744451522827148,-32.213680267333984,-32.625560760498047,-33.042488098144531,-33.586662292480469,-33.854522705078125,-34.246883392333984,-34.77447509765625,-35.156402587890625,-35.478717803955078,-36.017684936523438,-36.419525146484375,-36.996128082275391,-37.475513458251953,-37.944705963134766,-38.317722320556641,-38.800022125244141,-39.332756042480469,-39.814510345458984,-40.517528533935547,-40.920856475830078,-41.486358642578125,-42.005428314208984,-42.632450103759766,-43.288738250732422,-43.729610443115234,-44.304676055908203,-45.030567169189453,-45.251136779785156,-45.788860321044922,-46.133846282958984,-46.817672729492188,-46.992988586425781,-47.512283325195313,-48.023807525634766,-48.3260498046875,-48.82171630859375])
elif 1:
    #measurement with input angle 10deg and output angle 11.5deg
    x_raw = ar([1510.0208,1510.5302,1511.0379,1511.5329,1512.0293,1512.524,1513.0326,1513.5416,1514.0405,1514.5385,1515.0274,1515.5311,1516.0301,1516.5321,1517.0392,1517.5425,1518.0455,1518.5339,1519.0249,1519.5235,1520.0292,1520.5385,1521.0368,1521.5361,1522.0305,1522.5345,1523.0373,1523.5331,1524.0314,1524.5256,1525.0374,1525.5394,1526.0359,1526.5273,1527.021,1527.5269,1528.0279,1528.5325,1529.0262,1529.5262,1530.0273,1530.5227,1531.0226,1531.5218,1532.0292,1532.5286,1533.0219,1533.5175,1534.014,1534.5254,1535.0347,1535.5374,1536.0319,1536.5248,1537.0255,1537.52,1538.0214,1538.5226,1539.026,1539.5281,1540.0184,1540.5213,1541.0233,1541.5368,1542.0364,1542.5339,1543.0308,1543.528,1544.0327,1544.5274,1545.0207,1545.5185,1546.0209,1546.5341,1547.0336,1547.533,1548.0213,1548.5277,1549.0354,1549.5391,1550.036,1550.5273,1551.027,1551.524,1552.0233,1552.5257,1553.0298,1553.5369,1554.0302,1554.5254,1555.0188,1555.5262,1556.0341,1556.5317,1557.0287,1557.5207,1558.026,1558.5236,1559.0247,1559.5248,1560.0252,1560.5276,1561.0152,1561.5129,1562.0121,1562.5244,1563.0332,1563.5326,1564.031,1564.5262,1565.0306,1565.5261,1566.0222,1566.5219,1567.0259,1567.5354,1568.0298,1568.5234,1569.0148,1569.5195,1570.0244,1570.5275,1571.0232,1571.5193,1572.0238,1572.5155,1573.0175,1573.5173,1574.0232,1574.5238,1575.0126,1575.5042,1576.0031,1576.5163,1577.0247,1577.5269,1578.0201,1578.5168,1579.0171,1579.5098,1580.0132,1580.5133,1581.0184,1581.5169,1582.0127,1582.5129,1583.0151,1583.5246,1584.0235,1584.5237,1585.0186,1585.5218,1586.0212,1586.5156,1587.0109,1587.5096,1588.0191,1588.5189,1589.0175,1589.5099,1590.0082,1590.5169,1591.0197,1591.5197,1592.0129,1592.514,1593.0104,1593.506,1594.0077,1594.5128,1595.017,1595.5115,1596.0092,1596.5061,1597.016,1597.525,1598.0255,1598.5189,1599.0138,1599.5174,1600.0131,1600.5155,1601.0159,1601.5216,1602.0216,1602.5146,1603.0134,1603.5131,1604.0209,1604.5205,1605.0217,1605.5173,1606.0194,1606.5182,1607.0101,1607.5068,1608.0071,1608.5196,1609.0207,1609.5186,1610.01,1610.5105,1611.0156,1611.5186,1612.0167,1612.511,1613.0119,1613.5056,1614.0048,1614.5078,1615.0193,1615.5221,1616.0146,1616.5092,1617.0077,1617.52,1618.0223,1618.5187,1619.01,1619.5092,1620.0099,1620.5102,1621.0137,1621.5155,1622.0203,1622.5123,1623.009,1623.5069,1624.0118,1624.5164])
    y_raw = ar([-22.405715942382813,-22.248315811157227,-22.053016662597656,-21.800394058227539,-21.625955581665039,-21.410137176513672,-21.209453582763672,-20.936101913452148,-20.881925582885742,-20.680871963500977,-20.525588989257813,-20.263761520385742,-20.056575775146484,-19.866567611694336,-19.754470825195313,-19.619932174682617,-19.496364593505859,-19.386425018310547,-19.25318717956543,-18.968193054199219,-18.841497421264648,-18.690126419067383,-18.454069137573242,-18.275173187255859,-18.132621765136719,-18.026660919189453,-17.988349914550781,-17.826700210571289,-17.660249710083008,-17.508039474487305,-17.332271575927734,-17.221162796020508,-17.123218536376953,-17.08531379699707,-17.038518905639648,-16.963617324829102,-16.834123611450195,-16.717344284057617,-16.625751495361328,-16.515647888183594,-16.399818420410156,-16.287708282470703,-16.184484481811523,-16.15776252746582,-16.123067855834961,-16.018890380859375,-15.936452865600586,-15.788228988647461,-15.709367752075195,-15.659036636352539,-15.61638355255127,-15.61334228515625,-15.586030960083008,-15.531342506408691,-15.451549530029297,-15.417159080505371,-15.24191951751709,-15.169781684875488,-15.184613227844238,-15.157497406005859,-15.164961814880371,-15.250646591186523,-15.128497123718262,-15.020374298095703,-15.079591751098633,-14.991185188293457,-14.963403701782227,-15.01830005645752,-15.052685737609863,-15.084575653076172,-15.094922065734863,-15.080177307128906,-15.026492118835449,-14.971720695495605,-14.964550018310547,-14.986340522766113,-14.982373237609863,-15.077774047851563,-15.073947906494141,-15.09234619140625,-15.11749267578125,-15.08100700378418,-15.063412666320801,-15.081647872924805,-15.128927230834961,-15.234662055969238,-15.265422821044922,-15.347700119018555,-15.361766815185547,-15.366703987121582,-15.357009887695313,-15.378541946411133,-15.525381088256836,-15.457094192504883,-15.563252449035645,-15.65577220916748,-15.783328056335449,-15.832945823669434,-15.889346122741699,-15.877164840698242,-15.925895690917969,-16.015996932983398,-16.176149368286133,-16.233245849609375,-16.461910247802734,-16.542856216430664,-16.621719360351563,-16.68443489074707,-16.848934173583984,-16.78297233581543,-16.967599868774414,-17.034126281738281,-17.18528938293457,-17.339649200439453,-17.494880676269531,-17.514904022216797,-17.683450698852539,-17.769374847412109,-17.87809944152832,-18.006393432617188,-18.167434692382812,-18.322093963623047,-18.454132080078125,-18.702945709228516,-18.761865615844727,-18.833566665649414,-18.906293869018555,-18.982217788696289,-19.080194473266602,-19.186098098754883,-19.363935470581055,-19.518199920654297,-19.728116989135742,-19.885322570800781,-19.92970085144043,-20.048055648803711,-20.146266937255859,-20.296085357666016,-20.503509521484375,-20.684196472167969,-20.931386947631836,-21.161184310913086,-21.309001922607422,-21.456888198852539,-21.611963272094727,-21.791908264160156,-21.856271743774414,-22.155235290527344,-22.37523078918457,-22.619739532470703,-22.884521484375,-23.176746368408203,-23.338380813598633,-23.583847045898437,-23.71923828125,-23.892156600952148,-24.369964599609375,-24.605646133422852,-25.066806793212891,-25.194911956787109,-25.545019149780273,-25.797483444213867,-25.999967575073242,-26.190303802490234,-26.430271148681641,-26.619964599609375,-26.882125854492187,-27.217052459716797,-27.704311370849609,-27.920148849487305,-28.258665084838867,-28.521686553955078,-28.7606201171875,-29.08856201171875,-29.400976181030273,-29.663408279418945,-29.999591827392578,-30.38304328918457,-30.794050216674805,-31.205314636230469,-31.518743515014648,-31.935630798339844,-32.240119934082031,-32.602252960205078,-33.155605316162109,-33.419681549072266,-33.858154296875,-34.290054321289063,-34.628257751464844,-35.188209533691406,-35.649612426757813,-36.018581390380859,-36.589309692382813,-37.117095947265625,-37.661735534667969,-38.135257720947266,-38.679214477539063,-39.227104187011719,-39.703361511230469,-40.16754150390625,-40.834823608398437,-41.401523590087891,-41.804782867431641,-42.357372283935547,-42.813976287841797,-43.479587554931641,-44.015865325927734,-44.322238922119141,-44.914768218994141,-45.400306701660156,-45.790786743164063,-46.401004791259766,-46.947471618652344,-47.1209716796875,-47.53582763671875,-48.106380462646484,-48.036003112792969,-48.327869415283203,-48.735214233398438,-49.117683410644531,-49.206069946289063,-48.807308197021484,-49.387779235839844,-49.0780029296875,-49.061389923095703,-49.297451019287109,-49.710914611816406,-50.081546783447266,-50.152961730957031,-50.225715637207031])
elif 0:
"""
#read data from xml file
filename = r'\\winbe\oiodata\01_data\PA300\dong87\P162388\D06_17362\pitch_sweep\P162388_D06_17362_(0,0)_SIPP24_11.0(15.0d)_1550_L-L_R-R_P-P.xml'
with open(filename, 'r') as f:
    ObjectData = obj.fromstring(f.read())
    dataxml = ObjectData.OpticalMeasurements.LossMeasurement.WaveguideLossMeasurement.PortLossMeasurement.MeasurementResult
    #x_raw = xml_to_array(dataxml.PortLossMeasurement.MeasurementResult[0].L)
    x_raw = dataxml.L
   # y_raw = xml_to_array(dataxml.PortLossMeasurement.MeasurementResult[0].IL) 
    y_raw = dataxml.IL
	
x_raw = readxml(x_raw)
y_raw = readxml(y_raw)
#print y_raw_temp
#print(x_raw)



					#limit wavelength window
peak = np.max(y_raw)
idx = np.argwhere(y_raw > peak - 3.0)
x_raw_fit = x_raw[idx][:,0]
y_raw_fit = y_raw[idx][:,0]

# p0 is the initial guess for the fitting coefficients (A, mu and sigma above)
p0 = np.array([20.0, 1550.0, 60.0, 20.0, 100.0])
#bnd = np.array([5.0, 10.0, 20.0, 20.0, 1000.0])
bnd = np.array([5.0, 70.0, 20.0, 20.0, 1000.0])

coeff, var_matrix = curve_fit(gauss, x_raw_fit, y_raw_fit, p0=p0, method='trf', bounds=(p0-bnd, p0+bnd))

# Get the fitted curve
hist_fit = gauss(x_raw_fit, *coeff)

plt.plot(x_raw, y_raw, label='Test data')
plt.plot(x_raw_fit, hist_fit, label='Fitted data')

# Finally, lets get the fitting parameters, i.e. the mean and standard deviation:
print 'Fitted mean1 = ', coeff[1]
print 'Fitted standard deviation = ', coeff[2]
print 'Fitted mean2 = ', coeff[1] + coeff[3]
print 'Peak wavelength delta = ', coeff[3]

plt.show()
